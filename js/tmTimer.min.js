var audioElement,counter=1,selected=-1,minimum=0,average=0,maximum=0,selectedColor=0,green=0,yellow=0,red=0,isBeepEnabled="false",lastColor="white",isPaused=!1,isStarted=!1,isCustom=!1,bColors=["white","black"],supportsOrientationChange="onorientationchange"in window,orientationEvent=supportsOrientationChange?"orientationchange":"resize",times=[[10,20,30],[240,300,360],[300,360,420],[480,540,600],[60,75,90],[120,150,180],[300,330,360],[60,90,120],[600,660,720],[780,840,900],[1080,1170,1200]];function getTime(){return(new Date).clearTime().addSeconds(counter).toString("H:mm:ss")}function getMobileOperatingSystem(){var e=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(e)?"Windows Phone":/android/i.test(e)?"Android":/iPad|iPhone|iPod/.test(e)&&!window.MSStream?"iOS":"unknown"}function btnStopClick(e){var t=$("#txtMember").val(),o=getTime();isStarted&&e&&addNewTime(t,$("#selectTimes").find(":selected").text(),o,lastColor),$("#btnPause").hide(),$("#btnPlay").show(),lastColor=bColors[selectedColor],document.body.style.backgroundColor=lastColor,$("#divCurrentTime").css("background-color",lastColor),$("#timeContent").css("background-color",lastColor),$("#pTime").text("0:00:00"),$("#txtMember").val(""),selected=-1,counter=1,isPaused=!0,isStarted=!1,0==selectedColor?($("#pTime,.lblFooter").css("color","black"),changeImages("-gray")):($("#pTime,.lblFooter").css("color","white"),changeImages("")),$("#selectTimes").prop("disabled",!1),$("#btnRestart").prop("disabled",!1),green=0,red=0,yellow=0}function btnStartClick(){isStarted||(isStarted=!0,isPaused=!1,""!=(selected=$("#selectTimes").val())&&null!=selected&&(isCustom||(minimum=times[selected][0],average=times[selected][1],maximum=times[selected][2]),startTimer(),$("#selectTimes").prop("disabled","disabled"),$("#btnRestart").prop("disabled","disabled"),changeImages(0==selectedColor?"-gray":"")))}function btnPauseClick(){isPaused=!0}function startBeep(){"true"==isBeepEnabled&&(1==green||1==yellow||1==red?(audioElement.play(),setTimeout(function(){audioElement.pause()},500)):audioElement.pause())}function startTimer(){var e=setInterval(function(){isPaused?clearInterval(e):($("#pTime").text(getTime()),counter>=minimum&&counter<average?(changeImages(""),lastColor="green",$("#pTime,.lblFooter").css("color","white"),green++,startBeep()):counter>=average&&counter<maximum?(changeImages("-gray"),lastColor="yellow",$("#pTime,.lblFooter").css("color","black"),yellow++,startBeep()):counter>=maximum?(changeImages(""),lastColor="red",$("#pTime,.lblFooter").css("color","white"),red++,startBeep()):lastColor=bColors[selectedColor],document.body.style.backgroundColor=lastColor,$("#timeContent").css("background-color",lastColor),$("#divCurrentTime").css("background-color",lastColor),counter++)},1e3)}function changeImages(e){$("#btnPlay").attr("src","images/play"+e+".png"),$("#btnPause").attr("src","images/pause"+e+".png"),$("#btnStop").attr("src","images/stop"+e+".png"),!isPaused&&isStarted?($("#btnRestart").attr("src","images/restart"+e+"-dis.png"),$("#btnRestart").attr("title","You must stop the timer in order to restart.")):($("#btnRestart").attr("src","images/restart"+e+".png"),$("#btnRestart").attr("title","Restart and start from scratch (it doesn't store the speaker's time)")),$("#btnTable").attr("src","images/table"+e+".png"),$("#btnTimer").attr("src","images/timer"+e+".png"),$("#btnInvert").attr("src","images/invert-colors"+e+".png"),"true"==isBeepEnabled?$("#btnBeep").attr("src","images/volume"+e+".png"):$("#btnBeep").attr("src","images/volume-off"+e+".png")}function changeImagesByColor(){changeImages(0!=selectedColor||"white"!=lastColor&&"yellow"!=lastColor?"":"-gray")}function resizeDivImage(){$(".divImage").height($(".divImage").height()-$(".bottom-footer").height()-$("#options").height())}function setBeep(e){null!==localStorage.getItem("myBeep")&&localStorage.removeItem("myBeep"),localStorage.setItem("myBeep",e)}function setColor(e){null!==localStorage.getItem("myPreferedColor")&&localStorage.removeItem("myPreferedColor"),localStorage.setItem("myPreferedColor",e)}function getBeep(){null!==localStorage.getItem("myBeep")?isBeepEnabled=localStorage.getItem("myBeep"):setBeep(isBeepEnabled)}function getCurrentColor(){null!==localStorage.getItem("myPreferedColor")?selectedColor=parseInt(localStorage.getItem("myPreferedColor")):setColor(selectedColor)}function setVolumeImg(){setBeep(isBeepEnabled),0!=selectedColor||"white"!=lastColor&&"yellow"!=lastColor?"false"==isBeepEnabled?$("#btnBeep").attr("src","images/volume-off.png"):$("#btnBeep").attr("src","images/volume.png"):"false"==isBeepEnabled?$("#btnBeep").attr("src","images/volume-off-gray.png"):$("#btnBeep").attr("src","images/volume-gray.png")}function setImgAndBng(){1==selectedColor?(changeImages(""),$("#pTime,.lblFooter").css("color","white")):(changeImages("-gray"),$("#pTime,.lblFooter").css("color","black")),setColor(selectedColor),lastColor=bColors[selectedColor],document.body.style.backgroundColor=lastColor,$("#timeContent").css("background-color",lastColor),$("#divCurrentTime").css("background-color",lastColor)}window.addEventListener(orientationEvent,function(){resizeDivImage()},!1),$(function(){(audioElement=document.createElement("audio")).setAttribute("src","sounds/beep.mp3"),audioElement.addEventListener("ended",function(){this.play()},!1),audioElement.addEventListener("canplay",function(){}),audioElement.addEventListener("timeupdate",function(){}),initializeDB(),resizeDivImage(),$('[data-toggle="tooltip"]').tooltip(),$(".timing").timingfield(),$("#cTopic").html("<div><div style='float:left'><b>Meeting at "+(new Date).toString("dd/MM/yyyy")+'</b></div><div style="float:right"><a href="#divConfirm" data-toggle="modal" data-target="#divConfirm"><span class="glyphicon glyphicon-trash"></span></a></div></div>'),$("#selectTimes").select2({placeholder:"Choose a time"}).on("change",function(){"11"==$(this).val()?$("#divCustomTime").modal():isCustom=!1}),$("#linkResults").click(function(){countTimetable(),printTable(),$("#divResults").modal()}),$("#btnPlay").click(function(){var e=$("#selectTimes").val();if(""==e||null==e){var t=document.getElementById("snackbar");return t.className="show",void setTimeout(function(){t.className=t.className.replace("show","")},3e3)}isStarted=!1,btnStartClick(),$(this).hide(),$("#btnPause").show(),changeImagesByColor()}),$("#btnPause").click(function(){btnPauseClick(),$(this).hide(),$("#btnPlay").show(),changeImagesByColor()}),$("#btnStop").click(function(){btnStopClick(!0)}),$("#btnBeep").click(function(){isBeepEnabled="true"==isBeepEnabled?"false":"true",setVolumeImg()}),$("#btnRestart").click(function(){btnStopClick(!1),isCustom=!1,minimum=0,average=0,maximum=0,$("#selectTimes").select2({placeholder:"Choose a time"}).val("").trigger("change")}),$("#btnSave").click(function(){var e=parseInt(360*$("input[type=text]")[2].value)+parseInt(60*$("input[type=text]")[3].value)+parseInt($("input[type=text]")[4].value),t=parseInt(360*$("input[type=text]")[6].value)+parseInt(60*$("input[type=text]")[7].value)+parseInt($("input[type=text]")[8].value),o=parseInt(360*$("input[type=text]")[10].value)+parseInt(60*$("input[type=text]")[11].value)+parseInt($("input[type=text]")[12].value);e>=t?$("#pError").html("The minimum time cannot be greater or equal than the average time.<br/>"):e>=o?$("#pError").html("The minimum time cannot be greater or equal than the maximum time.<br/>"):t>=o?$("#pError").html("The average time cannot be greater or equal than the maximum time.<br/>"):(isCustom=!0,minimum=e,average=t,maximum=o,$("#divCustomTime").modal("toggle"))}),$("#btnInvert").click(function(){selectedColor=0==selectedColor?1:0,setImgAndBng()}),$("#btnConfirm").click(function(e){e.preventDefault(),isStarted=!1,btnStopClick(!1),clearTimetable(),$("#hNoResults").show(),$("#tblResults").hide()}),$("[data-toggle]").click(function(){var e=this;setTimeout(function(){$(e).tooltip("hide")},1500)}),getCurrentColor(),getBeep(),setImgAndBng(),setVolumeImg();var e=getMobileOperatingSystem();"iOS"!=e&&"Android"!=e||$("#btnBeep").hide()});
